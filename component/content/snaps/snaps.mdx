import firstSnapHistory from './first-snap-history.png';
import snapOverview from './snap-overview.png';
import { Image } from '@teambit/docs.ui.zoomable-image';

# Component snaps

:::note Missing UI Capabilities
Snaps are safe to use, However, Snaps are not represented well in the UI.  
This feature is still under development.
:::

A Snap is an immutable and exportable Component version that is referenced using a hash.
Snaps are used for component collaboration, not for consumption. A snap has no semantic version to indicate where and how it can be used. It also has no corresponding published package.

The snap command runs the Component's Build and Snap pipelines before it creates a new version. The generated version is stored in the Local Scope where it is made available to be exported to a Remote Scope.

## Snap a Component

To snap a single component run the following:

```
bit snap COMPONENT_ID [--message SNAP_MESSAGE]
```

For example:

```bash
bit snap company.scope/ui/text --message "a demo snapshot"
```

Once the Snap pipeline is done the new snap can be seen in the Component's changelog, in the UI:

<Image src={firstSnapHistory} />

To review a Components changelog in the terminal, use the `bit log` command. For example:

```bash
bit log company.scope/ui/text
```

The output is similar to the following:

```
snap 2ec9427e94b56bd3ed886b7eea42e84563001f5d
author: itaymendel <itay@mydomain.com>
date: 11/14/2021, 12:25:52 PM

      a demo snapshot
```

:::info Snapping a modified Component
A versioned Component (either snapped or tagged) can be versioned again only if it has been modified since its last version.

A Component is considered modified if one or more of the following is true:

- One of its source files has been changed
- A file has been added to it, or removed
- Its dependency graph has been changed
- Its Component configuration has been changed
:::

## Snap a dependent Component

A Component may depend on another Component.
When that happens, the dependency graph of that dependent Component will reference the Snap version of its dependency.

For example, the following snaps `company.scope/ui/heading` which is dependent on `company.scope/ui/text`:

```
$ bit snap company.scope/ui/heading

...
1 component(s) snapped
(use "bit export" to push these components to a remote")
(use "bit untag" to unstage versions)

new components
(first version for components)
     > ui/heading@c8aa8acf00c855560443e5be9b8142c70a04c8b8
```

The following shows the latest snap version of `company.scope/ui/text` (`2ec9427e94b56bd3ed886b7eea42e84563001f5d`) as a dependency of the latest snap version of 
`company.scope/ui/heading`:

```
$ bit show company.scope/ui/heading@c8aa8acf00c855560443e5be9b8142c70a04c8b8

┌───────────────────┬──────────────────────────────────────────────────────────────────────────────┐
│ id                │ company.scope/ui/heading@c8aa8acf00c855560443e5be9b8142c70a04c8b8            │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────┤
│ ...               │ ...                                                                          │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────┤
│ dependencies      │ @company/scope.ui.text@2ec9427e94b56bd3ed886b7eea42e84563001f5d- (component) │
│                   │ classnames@2.3.1------------------------------------------------ (package)   │
│                   │ core-js@^3.0.0-------------------------------------------------- (package)   │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────┤
│ ...               │ ...                                                                          │
└───────────────────┴──────────────────────────────────────────────────────────────────────────────┘
```

## Undoing Snapshots

We can `reset` staged components, i.e., components that were snapped by not yet exported to a remote scope.  
Bit `reset` reverts the component to its previous state, i.e., `new`, `modified` or `exported`.

```bash
bit reset ui/text # Use bit reset to remote all staged snapshots from a component
bit reset --all # reset all versions from all components
```

This will remove all un-exported snapshots from the local component history. `reset` does not revert code changes made in the component.

## Snapshot in the Workspace

Bit understands the internal dependency graph of your workspace, and how your components are connected. SO while you can use the `snap` command per component, it accepts several features that simplify the flow when working with many components.

### Snapshot Modified Components

Use the `--all` flags to snapshot all modified components in the workspace. Bit will create a snap for each component, and if there are components with dependency relationships between them, their recent snapshots will be connected.  
With this feature, all snapshots will have the same log message.

```bash
bit snap --all --message "updating several components"
```

### Snapshot by Pattern

If you need to set different log message according to component namespaces, use a pattern to select the components you want to snap.

```bash
bit snap ui/* --message "one message for my ui components"
bit snap pages/* --message "another message for my pages"
```

### Auto-Snap Dependents

When you run `bit snap`, Bit can automatically snap all dependents of the component you are working on. Snap will propagate through all the dependents, and create a new snapshot for each of them.

```bash
bit snap ui/heading --message "my heading" --auto-snap-dependents
```
